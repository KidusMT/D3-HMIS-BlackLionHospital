<!DOCTYPE html>
<meta charset="UTF-8">
<title>Title</title>
<style>
    body {
        background: rgb(102, 102, 102);
    }

    .node {
        cursor: pointer;
    }

    .node rect {
        fill:rgb(37, 145, 161);
        stroke: steelblue;
        stroke-width: 2px;
    }

    /* .node circle {
            fill: #fff;
            stroke: steelblue;
            stroke-width: 3px;
        } */

    .node text {
        font: 12px sans-serif;
        fill: #000;
    }

    .link {
        fill: none;
        stroke: #ccc;
        stroke-width: 2px;
    }

    .tree {
        margin-bottom: 10px;
        overflow: auto;
    }
</style>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
    crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-1.10.1.min.js" integrity="sha256-SDf34fFWX/ZnUozXXEH0AeB+Ip3hvRsjLwp6QNTEb3k="
    crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>

<body>
    <div class="row">
    <div class="col-md-10" id="tree">

    </div>
    <div class="col-md-2" id="panel">
        <h1 id="title"></h1>
        <p id="desc"></p>
    </div>
    </div>
    <script>
        $(document).ready(function () {
            //build tree
            function BuildVerticaLTree(treeData, treeContainerDom) {
                var margin = { top: 60, right: 10, bottom: 0, left: 10 };
                var width = 1340 - margin.right - margin.left;//width of the svg canvas
                var height = 1250 - margin.top - margin.bottom;//height of the svg canvas



                //Time it takes for the animation to happen
                var i = 0, duration = 750;

                var tree = d3.layout.tree()
                    .size([height, width]);

                var diagonal = d3.svg.diagonal()
                    .projection(function (d) { return [d.x, d.y]; });
                var svg = d3.select(treeContainerDom).append("svg")
                    .attr("width", width + margin.right + margin.left)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate (" + margin.left + "," + margin.top + ")");
                root = treeData;

                update(root);
                function update(source) {
                    // Compute the new tree layout.
                    var nodes = tree.nodes(root).reverse(),
                        links = tree.links(nodes);
                    // Normalize for fixed-depth.
                    nodes.forEach(function (d) { d.y = d.depth * 70; });
                    // Declare the nodes…
                    var node = svg.selectAll("g.node")
                        .data(nodes, function (d) { return d.id || (d.id = ++i); });
                    // Enter the nodes.
                    var nodeEnter = node.enter().append("g")
                        .attr("class", "node")
                        .attr("transform", function (d) {
                            return "translate(" + source.x0 + "," + source.y0 + ")";
                        }).on("click", nodeclick);
                    nodeEnter.append("rect")
                        .attr("width", 120)
                        .attr("height", 20)
                        .attr("rx", 5)
                        .attr("ry", 5)
                        .attr("stroke", function (d) { return d.children || d._children ? "steelblue" : "#2591a1"; })
                        .style("fill", function (d) { return d.children || d._children ? "lightteal" : "#2591a1"; });
                    //.attr("r", 10)
                    //.style("fill", "#fff");
                    nodeEnter.append("text")
                        .attr("y", function (d) { return d.children || d._children ? 1 : 1; })//d.childern->for children, d._children-> for grandchildren
                        .attr("x", function (d) { return d.children || d._children ? 60 : 60; })//d.childern->for children, d._children-> for grandchildren
                        .attr("dy", "1em")
                        .attr("text-anchor", "middle")
                        .text(function (d) { return d.name; })
                        .style("fill-opacity", 1e-6);
                    // Transition nodes to their new position.
                    //horizontal tree
                    var nodeUpdate = node.transition()
                        .duration(duration)
                        .attr("transform", function (d) { return "translate(" + (d.x - 60) + "," + d.y + ")"; });
                    nodeUpdate.select("rect")
                        .attr("width", 120)
                        .attr("height", 20)
                        .style("fill", function (d) { return d._children ? "lightteal" : "#2591a1"; });
                    nodeUpdate.select("text")
                        .style("fill-opacity", 1);

                    // Transition exiting nodes to the parent's new position.
                    var nodeExit = node.exit().transition()
                        .duration(duration)
                        .attr("transform", function (d) { return "translate(" + source.x + "," + source.y + ")"; })
                        .remove();
                    nodeExit.select("rect")
                        .attr("r", 1e-6);
                    nodeExit.select("text")
                        .style("fill-opacity", 1e-6);
                    // Update the links…
                    // Declare the links…
                    var link = svg.selectAll("path.link")
                        .data(links, function (d) { return d.target.id; });
                    // Enter the links.
                    link.enter().insert("path", "g")
                        .attr("class", "link")
                        .attr("d", function (d) {
                            var o = { x: source.x0, y: source.y0 };
                            return diagonal({ source: o, target: o });
                        });
                    // Transition links to their new position.
                    link.transition()
                        .duration(duration)
                        .attr("d", diagonal);

                    // Transition exiting nodes to the parent's new position.
                    link.exit().transition()
                        .duration(duration)
                        .attr("d", function (d) {
                            var o = { x: source.x, y: source.y };
                            return diagonal({ source: o, target: o });
                        })
                        .remove();

                    // Stash the old positions for transition.
                    nodes.forEach(function (d) {
                        d.x0 = d.x;
                        d.y0 = d.y;
                    });
                }

                // Toggle children on click.
                function nodeclick(d) {
                    $("#title").replaceWith('<h1 id="title">'+d.full_name+"</h1>");
                    $("#desc").replaceWith('<p id="desc">' + d.description + "</p>");

                    if (d.children) {
                        d._children = d.children;
                        d.children = null;
                    } else {
                        if (d.parent.children) {
                            d.parent.children.forEach(function (d) {
                                if (d.children != null) {
                                    d._children = d.children
                                    d.children = null;
                                }
                            });
                        }
                        d.children = d._children;
                        d._children = null;
                    }
                    update(d);
                }
            }

            var treeData =
                {
                    "name": "AAU Board",
                    "full_name":"Addis Ababa University Board",
                    "parent": "null",
                    "description":"",
                    "children": [
                        {
                            "name": "President",
                             "full_name": "AAU Office of the President",
                            "parent": "AAU Board",
                             "description": "",
                            "children": [
                                {
                                    "name": "TASH Board",
                                     "full_name": "TASH Governing Board",
                                    "parent": "President",
                                     "description": "",
                                    "children": [
                                        {
                                            "name": "OED for CHS",
                                             "full_name": "OED for CHS with BP rank",
                                            "parent": "TASH Board",
                                             "description": "",
                                            "children": [
                                                {
                                                    "name": "Dir research",
                                                     "full_name": "Director for Research",
                                                    "parent": "OED for CHS",
                                                     "description": "",
                                                    "children": []
                                                },
                                                {
                                                    "name": "Dir. Clinical",
                                                     "full_name": "Director for Clinical Services",
                                                    "parent": "OED for CHS",
                                                     "description": "",
                                                    "_children": [
                                                        {
                                                            "name": "Nursing",
                                                            "full_name": "Nursing Directorate",
                                                            "parent": "Dir. Clinical",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "Clinical Dep.",
                                                            "full_name": "Clinical Departments",
                                                            "parent": "Dir. Clinical",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "Pharmacy",
                                                            "full_name": "Pharmacy and Medical Supplies Directorate",
                                                            "parent": "Dir. Clinical",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "Diagnostics",
                                                            "full_name": "Diagnostics Directorate",
                                                            "parent": "Dir. Clinical",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "OPD",
                                                            "full_name": "Outpatient Directorate",
                                                            "parent": "Dir. Clinical",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "OR",
                                                            "full_name": "Operation Theatre Directorate",
                                                            "parent": "Dir. Clinical",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "Biomedical",
                                                            "full_name": "Biomedical Directorate",
                                                            "parent": "Dir. Clinical",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "ER",
                                                            "full_name": "Emergency Directorate",
                                                            "parent": "Dir. Clinical",
                                                             "description": "",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "name": "Dir. Academic",
                                                    "full_name": "Director for Academic Affairs",
                                                    "parent": "OED for CHS",
                                                     "description": "",
                                                    "_children": [
                                                        {
                                                            "name": "Associate D.",
                                                            "full_name": "Assiciate Director for Academic Standards and Staff Affairs",
                                                            "parent": "Dir. Academic",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "All school D.",
                                                            "full_name": "All School Deans",
                                                            "parent": "Dir. Academic",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "Non-Clinical",
                                                            "full_name": "Non-Clinical Departments",
                                                            "parent": "Dir. Academic",
                                                             "description": "",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "name": "Dir. Business",
                                                    "full_name": "Director for Business Development and Adminsitration",
                                                    "parent": "OED for CHS",
                                                     "description": "",
                                                    "_children": [
                                                        {
                                                            "name": "Budget & finance",
                                                            "full_name": "Budget and Finances",
                                                            "parent": "Dir. Business",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "General service",
                                                            "full_name": "General Services",
                                                            "parent": "Dir. Business",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "Property & resource",
                                                            "full_name": "Property Adminstration and Resource Management",
                                                            "parent": "Dir. Business",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "HRM & Dev't",
                                                            "full_name": "HRM and Development",
                                                            "parent": "Dir. Business",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": " Procurement",
                                                            "full_name": "Procurement",
                                                            "parent": "Dir. Business",
                                                             "description": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "name": "Student affair",
                                                            "full_name": "Student Affairs",
                                                            "parent": "Dir. Business",
                                                             "description": "",
                                                            "children": []
                                                        }

                                                    ]
                                                }

                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                };
            BuildVerticaLTree(treeData, "#tree");
        });
    </script>